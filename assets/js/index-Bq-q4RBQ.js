import{c as e,o as t,a,t as r,F as n,r as i,b as o,n as l,d as s,e as c,f as d,g as u,h as g,i as f,j as v,k as h}from"./vue-vendor-De7iXkLg.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const a of e)if("childList"===a.type)for(const e of a.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();async function y(){try{const e=await fetch("https://hao123.web025.cn/api.php?action=get_all_data");if(!e.ok)throw new Error("API请求失败");const t=await e.json();if(1===t.code&&t.data)return{websites:t.data.websites,categories:[{id:"all",name:"全部"},...t.data.categories.filter((e=>"all"!==e.identifier)).map((e=>({id:e.identifier,name:e.name})))]};throw new Error("数据格式不正确")}catch(e){return{websites:[],categories:[{id:"all",name:"全部"}]}}}async function p(){try{const e=await fetch("https://zj.v.api.aa1.cn/api/weibo-rs/");if(!e.ok)throw new Error("API请求失败");const t=await e.json();if(1===t.code&&t.data&&Array.isArray(t.data))return t.data.slice(0,10).map((e=>({title:e.title,hot:e.hot?e.hot.toString():"",url:`https://s.weibo.com/weibo?q=%23${encodeURIComponent(e.title)}%23&t=31&band_rank=8&Refer=top`})));throw new Error("数据格式不正确")}catch(e){return[{title:"微博热搜实时数据1",hot:"5012万",url:"#"},{title:"最新科技发布会",hot:"4389万",url:"#"},{title:"国内重要新闻动态",hot:"3756万",url:"#"},{title:"热门影视作品上映",hot:"2934万",url:"#"},{title:"体育赛事最新战报",hot:"2145万",url:"#"}].map((e=>({...e,url:`https://s.weibo.com/weibo?q=%23${encodeURIComponent(e.title)}%23&t=31&band_rank=8&Refer=top`})))}}const m={class:"container"},w={class:"header"},b={class:"date-info"},k={class:"date-day"},_={class:"category-nav"},I=["onClick"],E={class:"grid-container"},C=["href","data-category"],D=["src","alt"],L={class:"trending"},A={class:"trending-list"},O={key:0},P={key:1},j=["href"],N={key:0,class:"hot-count"};const R=((e,t)=>{const a=e.__vccOpts||e;for(const[r,n]of t)a[r]=n;return a})({__name:"NavPage",setup(e,{expose:t}){t();const a=c([]),r=c([]),n=c(!0),i=c(null);let o=null;const l=c(null),s=c(null);async function v(){n.value=!0,i.value=null;try{r.value=await p()}catch(e){i.value="获取热搜数据失败，请稍后再试"}finally{n.value=!1}}const h=()=>{l.value=new IntersectionObserver((e=>{e.forEach((e=>{e.isIntersecting&&(v(),l.value.unobserve(e.target))}))}),{threshold:.1,rootMargin:"50px"}),s.value&&l.value.observe(s.value)};d((async()=>{await w(),await v(),h(),o=setInterval(v,36e5)})),u((()=>{o&&clearInterval(o),l.value&&l.value.disconnect()}));const m=c([{id:"all",name:"全部"}]);async function w(){try{const e=await y();a.value=e.websites,m.value=e.categories}catch(e){}}const b=new Date,k=b.getDate(),_=["星期日","星期一","星期二","星期三","星期四","星期五","星期六"][b.getDay()],I=b.getMonth()+1,E=b.getFullYear(),C=c("all"),D=g((()=>"all"===C.value?a.value:a.value.filter((e=>e.category===C.value)))),L={websites:a,trendingItems:r,trendingLoading:n,trendingError:i,get trendingInterval(){return o},set trendingInterval(e){o=e},observer:l,lazyLoadRef:s,getTrendingData:v,initObserver:h,categories:m,fetchData:w,currentDate:b,day:k,weekday:_,month:I,year:E,activeCategory:C,filteredWebsites:D,changeCategory:e=>{C.value=e},ref:c,computed:g,onMounted:d,onUnmounted:u,defineAsyncComponent:f,get fetchNavigationData(){return y},get fetchTrendingData(){return p}};return Object.defineProperty(L,"__isScriptSetup",{enumerable:!1,value:!0}),L}},[["render",function(c,d,u,g,f,v){return t(),e("div",m,[a("div",w,[d[0]||(d[0]=a("h1",null,"网站导航",-1)),a("div",b,[a("div",k,r(g.day),1),a("div",null,r(g.weekday),1),a("div",null,r(g.year)+"年"+r(g.month)+"月",1)])]),a("div",_,[(t(!0),e(n,null,i(g.categories,(a=>(t(),e("div",{key:a.id,class:l(["category-item",{active:g.activeCategory===a.id}]),onClick:e=>g.changeCategory(a.id)},r(a.name),11,I)))),128))]),a("div",E,[(t(!0),e(n,null,i(g.filteredWebsites,(n=>(t(),e("a",{key:n.name,href:n.url,class:"grid-item","data-category":n.category,target:"_blank"},[a("img",{src:n.img,alt:n.name},null,8,D),a("span",null,r(n.name),1)],8,C)))),128))]),a("div",L,[d[1]||(d[1]=a("h3",null,"热搜榜",-1)),a("ul",A,[g.trendingLoading?(t(),e("li",O,"加载中...")):o("",!0),g.trendingError?(t(),e("li",P,r(g.trendingError),1)):o("",!0),g.trendingLoading||g.trendingError?o("",!0):(t(!0),e(n,{key:2},i(g.trendingItems,((n,i)=>(t(),e("li",{key:n.title},[a("a",{href:n.url,target:"_blank"},[a("span",{class:l({"top-1":0===i,"top-2":1===i,"top-3":2===i})},r(i+1),3),s(" "+r(n.title)+" ",1),n.hot?(t(),e("small",N,r(n.hot),1)):o("",!0)],8,j)])))),128))])])])}],["__scopeId","data-v-22b02909"]]);h({__name:"App",setup:e=>(e,a)=>(t(),v(R))}).mount("#app");
